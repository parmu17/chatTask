<!DOCTYPE html>
<html lang="en-US">
	<head>
		<title>LWPTECH</title>
	</head>
	 
	<body>
    <div>
    <h1 style="text-align: center; color:red; background-color: black;">Chat Application</h1>
    <label>Received Message: <span id="received_msg"></span></label><br><br>
    <form id='form_submit1'>
      <input id='msg_inp' placeholder="Write your message here"> &nbsp;
      <button >Send</button>
    </form>
    <br>
    <!--<button type='button' id='btn1'>Button-1</button><br> -->
    <button type='button' id='send_loc'>Send Location</button><br>
    </div>

    <script src="/socket.io/socket.io.js"></script>
    <script type="text/javascript">
      const socket = io();
      socket.on('event1', (msg1)=>{
        console.log(msg1);
        document.getElementById('received_msg').innerHTML = msg1;
      })

      document.querySelector('#form_submit1').addEventListener('submit', (e)=>{
        e.preventDefault();
        const userMsg = e.target.elements.msg_inp.value; //text from html form
        socket.emit('event2', userMsg, (ackMsg1)=>{
          if(!ackMsg1){
            console.log('successfully delivered..');
          }else{
            console.log(ackMsg1);
          }
        });
      })

      socket.on('event3', (msg4)=>{
        console.log(msg4);
        document.getElementById('received_msg').innerHTML = msg4;
      })

      document.querySelector('#send_loc').addEventListener('click', ()=>{
        if(!navigator.geolocation){
          alert('Geolocation is not supported by your browser..');
        }else{
          navigator.geolocation.getCurrentPosition((position)=>{
            socket.emit('location_event', {lati:position.coords.latitude, longi:position.coords.longitude}, (ackMsg2)=>{
              if(!ackMsg2){
                console.log('location shared..');
              }else{
                console.log(ackMsg2);
              }
            });
          })
        }
      })

    </script>
	</body>
</html>
